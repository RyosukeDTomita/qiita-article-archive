---
title: MicrosoftDocsのMCP ServerをVSCode + GitHub Copilotで使う
tags:
  - Microsoft
  - VSCode
  - MCP
  - GitHubCopilot
private: false
updated_at: '2025-08-08T15:43:15+09:00'
id: b33b70773c072f2cf2c1
organization_url_name: nri
slide: false
ignorePublish: false
---
## これは何?

https://github.com/MicrosoftDocs/mcp

Microsoftの公式ドキュメントをMCP Server化したものを使ってみたメモ
初心者向けに設定を記載したつもり。

---

## VS Code(GitHub Copilot)での設定方法

### mcp.jsonに設定を記述する

:::note info
2025年6月のリリースから従来settings.jsonに指定していたmcpの設定がmcp.jsonに移動したらしい

> Dedicated storage: MCP servers are now stored in a dedicated mcp.json file within each profile, rather than cluttering your user settings file[^1]
:::


コントロールパネルからMCPの設定ファイルを開いて追加する。

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3718390/3f48ec78-b2f2-42b1-aaff-ba7d49ceeba6.png)


```mcp.json
{
  "servers": {
    "microsoft.docs.mcp": {
      "type": "http",
      "url": "https://learn.microsoft.com/api/mcp"
    }
  }
}
```

:::note warn
設定ファイルがRunningではなく、Startなどになっているときにはクリックして起動が必要
![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3718390/1b5b46f8-12c7-4792-b380-aea20c53ecb3.png)
:::

試しに実行してみるとurl付きで答えてくれるので、url先を見に行くことでAIがハルシネーションを言っているかの確認がしやすい。

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3718390/3bdac51a-10f0-4319-a9aa-13b2b7d01069.png)

---

## システムプロンプトを書いてみる

```.github/copilot-instructions.md
## 調査方針

### Microsoft公式MCP Serverの活用

- **microsoft-docs-mcp**を使用してMicrosoft公式ドキュメントから情報を調査すること
- このMCP Server以外を情報源としてはならない

---

## 回答方針

- 回答はresult.mdに出力してください。

以下が回答フォーマット例です。例: Microsoft Teamsのデータ保存場所はどこですか?

Microsoft Teamsの保存場所はMicrosoft 365管理センターから確認できます。

根拠のurl
https://learn.microsoft.com/ja-jp/microsoftteams/privacy/location-of-data-in-teams

回答の根拠となった引用部分はこちら

> Teams データの保存場所
> ご利用のテナントのデータがどの地域に格納されるかを確認するには、[Microsoft 365 管理センター]>[設定]>[組織プロファイル] に移動してください。 下にスクロールして [データの場所] に移動します。
 
```

複眼チェックがURL先に遷移して、引用部分の記述を探すだけになって非常に楽になった。

---

## 感想、今後の検討

- もらったurlをAI系のブラウザで開くと該当箇所を探すのが楽そう。
- たまにurlのリンクが切れている時があった。

---

## Reference

[^1]: https://code.visualstudio.com/updates/v1_102#_mcp-servers-as-first-class-resources

