---
title: CodecovでREADMEにテストカバレッジを表示する with Java(Jacoco)
tags:
  - Java
  - jacoco
  - カバレッジ
  - Readme
  - codecov
private: false
updated_at: '2025-09-20T00:27:13+09:00'
id: 95bff2087f32cf96fd53
organization_url_name: null
slide: false
ignorePublish: false
---
## これは何?

GitHubで公開しているリポジトリのREADMEにテストカバレッジを表示したくなったのですが、結構ハマったのでメモ代わりにうまくいった手順を記載します。

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3718390/2394e900-a654-4a95-bd0b-e203d457fa3a.png)

---

## 環境

- Java 21系
    - [Gradle](https://gradle.org/): 9.0.0
    - [Jacoco](https://www.eclemma.org/jacoco/): 0.8.13

---

## うまくいった方法

1. [Codecov](https://app.codecov.io)のアカウントを作成する
2. GitHubにCodecovのアプリをインストールする。https://github.com/apps/codecov/installations/select_target
3. Codecovを使用したいリポジトリを選択してConfigureを押下する。
    ![Screenshot from 2025-09-19 22-22-43.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3718390/9a468ee4-bea6-43bd-b154-7b285f2a9ec5.png)
4. GitHub Actionsを使い、カバレッジを含むファイルをアップロードする。今回の場合は`build/reports/jacoco/test/jacocoTestReport.xml`が対象になる。
    [設定例](https://github.com/codecov/example-java-gradle/blob/main/.github/workflows/ci.yml)をもとにした[自分のリポジトリでの設定例](https://github.com/RyosukeDTomita/airis-burp-extensions/blob/main/.github/workflows/test-coverage.yml)↓

    ```yaml
    name: Test

    on:
      push:
        paths:
          - "src/**/*.java"
          - "build.gradle.kts"
          - "gradle/**"
          - ".github/workflows/*.yaml"
      pull_request:
        paths:
          - "src/**/*.java"
          - "build.gradle.kts"
          - "gradle/**"

    jobs:
      test:
        runs-on: ubuntu-latest
        permissions:
          contents: read
          pull-requests: write # Codecovがプルリクエストにコメントするために必要

        steps:
        - name: Checkout code
          uses: actions/checkout@v4
          with:
            fetch-depth: 0 # Codecovが正しく動作するために履歴全体を取得

        - name: Set up Java 21
          uses: actions/setup-java@v4
          with:
            java-version: '21'
            distribution: 'temurin'

        - name: Setup Gradle
          uses: gradle/actions/setup-gradle@v3

        - name: Grant execute permission for gradlew
          run: chmod +x gradlew

        - name: Run tests with coverage
          run: ./gradlew test jacocoTestReport && ls build/reports/jacoco/test/jacocoTestReport.xml

        - name: Upload coverage to Codecov
          uses: codecov/codecov-action@v5

        - name: Archive test results
          uses: actions/upload-artifact@v4
          if: always()
          with:
            name: test-results
            path: |
              build/reports/tests/
              build/reports/jacoco/
    ```
    
5. README.mdにCodecovのBadges & Graphsにあるurlをコピペする。
![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3718390/001940a5-b553-458c-a82f-c372d3fe8d6d.png)

ちょっと待つとREADME.mdに付けたバッチのステータスがunknownからカバレッジになる。

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3718390/2394e900-a654-4a95-bd0b-e203d457fa3a.png)

---

## バッチがunknownになる時の対処方

READMEに配置したバッチをクリックした時に以下のような画面に遷移した場合、カバレッジのデータの連携がうまくいっていない

![image.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3718390/b8ab449d-b6d9-4bbe-80b6-1d0dca6e4bb8.png)

設定が上手くいっている場合↓

![Screenshot from 2025-09-19 22-43-38.png](https://qiita-image-store.s3.ap-northeast-1.amazonaws.com/0/3718390/782a068a-ef29-42c0-a376-f7ee86daabaa.png)
